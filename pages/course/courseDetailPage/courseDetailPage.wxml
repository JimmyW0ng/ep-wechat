<!--pages/course/courseDetailPage/courseDetailPage.wxml-->
<view class='page'>
  <view class='course-list-item' bindtap='goCourseDetailPage'>
    <view class='course-avatar-wrap'>
      <image class="course-avatar" src="{{course.mainPicUrl}}" mode="scaleToFill"></image>
    </view>
    <view class='course-info'>
      <view class='course-org-name'>{{course.courseName}}</view>
      <view class='course-simple-info'>
        <view class='course-tag'>{{course.label}}</view>
        <view class='course-name'>{{course.courseIntroduce}}</view>
      </view>
      <view class='course-bottom-info'>
        <view class='course-note'>{{course.courseNote}}</view>
      </view>
    </view>
  </view>

  <view class='tab-header' style="display: flex; flex-direction:row;">
    <view class="tab-selector {{selectedTab == 0 && 'active'}}" data-tab="0" bindtap='selectTab'>课程介绍</view>
    <view class="tab-selector {{selectedTab == 1 && 'active'}}" data-tab="1" bindtap='selectTab'>老师介绍</view>
    <view class="tab-selector {{selectedTab == 2 && 'active'}}" data-tab="2" bindtap='selectTab'>评价</view>
  </view>

  <swiper style="height:{{swiperHeight}}px; padding-bottom: 50px" indicator-dots="{{false}}" current="{{selectedTab}}" autoplay="{{false}}" bindchange="changeSwiper">
    <swiper-item>
      <scroll-view scroll-y="true" class="scoll-h">
        <view class='tab-content course-introduce'>
          <view class='tab-content-title'>报名须知</view>
          <view class='tab-join-notice'>
            {{course.courseContent}}
          </view>
        </view>
      </scroll-view>
    </swiper-item>

    <swiper-item>
      <scroll-view scroll-y="true" class="scoll-h">
        <view class='tab-content course-team'>
          <view class='tab-content-title'>老师介绍
            <view class='title-info'>({{team.length}}位)</view>
          </view>

          <view class='teacher-item' wx:for="{{team}}" wx:key="index">
            <view class='teacher-basic'>
              <view class='teacher-avatar-wrap'>
                <image class="teacher-avatar" src="{{course.mainPicUrl}}" mode="scaleToFill"></image>
              </view>
              <view class='teacher-info'>
                <view class='teacher-title'>授课老师</view>
                <view class='teacher-name'>{{item.nickName}}</view>
              </view>
            </view>

            <view class='teacher-introduce'>{{item.introduce}}</view>
          </view>

          <view class='teacher-item' wx:for="{{team}}" wx:key="index">
            <view class='teacher-basic'>
              <view class='teacher-avatar-wrap'>
                <image class="teacher-avatar" src="{{course.mainPicUrl}}" mode="scaleToFill"></image>
              </view>
              <view class='teacher-info'>
                <view class='teacher-title'>授课老师</view>
                <view class='teacher-name'>{{item.nickName}}</view>
              </view>
            </view>

            <view class='teacher-introduce'>{{item.introduce}}</view>
          </view>

          <view class='teacher-item' wx:for="{{team}}" wx:key="index">
            <view class='teacher-basic'>
              <view class='teacher-avatar-wrap'>
                <image class="teacher-avatar" src="{{course.mainPicUrl}}" mode="scaleToFill"></image>
              </view>
              <view class='teacher-info'>
                <view class='teacher-title'>授课老师</view>
                <view class='teacher-name'>{{item.nickName}}</view>
              </view>
            </view>

            <view class='teacher-introduce'>{{item.introduce}}</view>
          </view>
        </view>
      </scroll-view>
    </swiper-item>

    <swiper-item>
      <scroll-view scroll-y="true" class="scoll-h">

        <view class='tab-content course-comments'>
          <view class='tab-content-title'>评价
            <view class='title-info'>({{comments.length}}条)</view>
          </view>

          <view class='comment-item' wx:for="{{comments}}" wx:key="index">
            <view class='comment-header'>
              <image class="child-avatar" src="{{item.childAvatar}}" mode="scaleToFill"></image>
              <view class='child-name'>{{item.childNickName}}</view>
              <view class='child-chosenFlag'>{{item.chosenFlag}} TODO</view>
            </view>
            <view class='comment-body'>
              <view class='comment-body-item'>{{item.createAt}}</view>
              <view class='comment-body-item'>{{item.className}}</view>
              <view class='comment-body-item'>{{item.score}}</view>
            </view>
            <view class='comment-footer'>{{item.content}}</view>
          </view>

          <view class='comment-check-all'>
            <view class='check-all-text'>查看全部评价 TODO icon</view>
            <view class='check-all-icon iconfont icon-right1'></view>
          </view>
        </view>
      </scroll-view>

    </swiper-item>
  </swiper>

  <view class='course-detail-footer'>
    <view class='footer-left'>
      <view class='iconfont icon-phone ripple' bindtap='callOgn' data-ognPhone="{{course.ognPhone}}"></view>
      <view class='footer-name'>机构</view>
    </view>

    <view class='footer-center'>
      <view class='footer-price'>￥{{course.prizeMin}}</view>
      <view class='footer-join-number'>已有{{course.totalParticipate}}人学习</view>
    </view>

    <view class='footer-right'>
      <view class='btn-primary ripple' bindtap='showPopup'>立即报名</view>
    </view>
  </view>

  <!-- 报名 PopUp -->
  <view class="zan-popup zan-popup--bottom {{popupStatus ? 'zan-popup--show' : ''}}">
    <view class="zan-popup__mask" bindtap='closePopup'></view>
    <view class="zan-popup__container join-container">
      <view class='join-title'>课程班次 TODO</view>

       <view class='date-list'>
        <view class="date-btn {{index == selectedDate && 'active'}}" wx:for="{{classes}}" wx:key="{{index}}" data-index="{{index}}" bindtap='chooseDate'>
          {{item.className}} {{item.classPrize}}
        </view>
      </view>  

      <view class='join-title'>上课宝贝</view>

      <view class='baby-list'>
        <view class="baby-list-item" bindtap='chooseChild' data-id="{{item.id}}" wx:for="{{childList}}" wx:key="{{index}}">
          <view class='baby-info'>
            <image class='item-avatar' src="{{item.avatar}}"></image>
            <view class='item-name'>{{item.name}}</view>
          </view>
          <view class="item-selector {{item.id == selectedChildId ? 'active' : ''}}">
            <view class='iconfont icon-right1'></view>
          </view>
        </view>
      </view>
      <view class='btn-primary ripple' bindtap='handleJoin'>确认报名</view>
    </view>
  </view>
</view>